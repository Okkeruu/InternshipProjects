{% extends "base.html" %}

{% block title %}ÎœÎµÏ„Î±Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Excel{% endblock %}

{% block content %}

<style>
    .container p {
        margin: 5px 0;
    }
</style>

<div class="container" style="
    font-family: Arial, sans-serif;
    background-color: #f5f0e6;   /* ÎœÎ Î•Î– Î¦ÎŸÎÎ¤ÎŸ */
    padding: 20px;
    border: 2px solid #d6c9b8;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    width: 400px;
    margin: 20px auto;
">

    <h2 style="text-align:center; margin-bottom:20px;">ÎœÎµÏ„Î±Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Î¿Ï… Excel</h2>

    <p>
        ğŸ“¥ Î‘Ï€ÏŒ ÎµÎ´Ï Î¼Ï€Î¿ÏÎµÎ¯Ï„Îµ Î½Î± Î±Î½ÎµÎ²Î¬ÏƒÎµÏ„Îµ Î±ÏÏ‡ÎµÎ¯Î¿ Excel Î³Î¹Î± ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· Î® ÎµÎ¹ÏƒÎ±Î³Ï‰Î³Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½.
    </p>

    <form method="POST" enctype="multipart/form-data" style="display:flex; flex-direction:column;">
        {% csrf_token %}

        <label for="id_file">ğŸ“ Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Î±ÏÏ‡ÎµÎ¯Î¿ Excel (.xlsx Î® .xls):</label>
        {{ form.as_p }}
        <p id="fileError" style="display:none; color:red; font-size:0.9em;"></p>

        <button type="submit" style="
            padding:10px 20px;
            background-color:#f5f0e6;
            color:#5cb85c;
            border:2px solid #5cb85c;
            border-radius:8px;
            font-weight:700;
            cursor:pointer;
        ">
            ÎœÎµÏ„Î±Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Î¿Ï…
        </button>

    <h3 style="margin-top:20px;">â„¹ï¸ ÎŸÎ´Î·Î³Î¯ÎµÏ‚ Ï€ÏÎ¹Î½ Ï„Î· Î¼ÎµÏ„Î±Ï†ÏŒÏÏ„Ï‰ÏƒÎ·</h3>
    <ul style="font-size:0.85em;">
        <li>âœ… Î¤Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ ÏƒÎµ Î¼Î¿ÏÏ†Î® <strong>.xlsx</strong> Î® <strong>.xls</strong></li>
        <li>ğŸ“Œ Î’ÎµÎ²Î±Î¹Ï‰Î¸ÎµÎ¯Ï„Îµ ÏŒÏ„Î¹ Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î± ÎµÎ¯Î½Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬ ÎºÎ±Î¹ Ï€Î»Î®ÏÎ·</li>
        <li>âš ï¸ Î— Î¼ÎµÏ„Î±Ï†ÏŒÏÏ„Ï‰ÏƒÎ· Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î±Î½Ï„Î¹ÎºÎ±Ï„Î±ÏƒÏ„Î®ÏƒÎµÎ¹ Ï…Ï€Î¬ÏÏ‡Î¿Î½Ï„Î± Î´ÎµÎ´Î¿Î¼Î­Î½Î±</li>
    </ul>

    <p style="margin-top:20px; font-size:0.8em;">
        â“ Î‘Î½ Î±Î½Ï„Î¹Î¼ÎµÏ„Ï‰Ï€Î¯ÏƒÎµÏ„Îµ ÎºÎ¬Ï€Î¿Î¹Î¿ Ï€ÏÏŒÎ²Î»Î·Î¼Î±, ÎµÏ€Î¹ÎºÎ¿Î¹Î½Ï‰Î½Î®ÏƒÏ„Îµ Î¼Îµ Ï„Î¿Î½ Î´Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î® Ï„Î¿Ï… ÏƒÏ…ÏƒÏ„Î®Î¼Î±Ï„Î¿Ï‚.
    </p>

</div>

<script>
    const form = document.querySelector('form');
    const fileInput = document.getElementById('id_file');
    const fileError = document.getElementById('fileError');

    form.addEventListener('submit', function(event) {
        let valid = true;

        if(!fileInput.value) {
            fileError.textContent = 'âŒ Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÏ€Î¹Î»Î­Î¾Ï„Îµ Î­Î½Î± Î±ÏÏ‡ÎµÎ¯Î¿ Excel.';
            fileError.style.display = 'block';
            fileInput.style.border = '2px solid red';
            valid = false;
        } else {
            const allowedExtensions = /(\.xlsx|\.xls)$/i;
            if(!allowedExtensions.exec(fileInput.value)) {
                fileError.textContent = 'âŒ ÎœÎ· Î­Î³ÎºÏ…ÏÎ· Î¼Î¿ÏÏ†Î® Î±ÏÏ‡ÎµÎ¯Î¿Ï…. Î•Ï€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Î¹ Î¼ÏŒÎ½Î¿ .xlsx Î® .xls';
                fileError.style.display = 'block';
                fileInput.style.border = '2px solid red';
                valid = false;
            } else {
                fileError.style.display = 'none';
                fileInput.style.border = '';
            }
        }

        if(!valid) {
            event.preventDefault();
        }
    });
</script>

{% endblock %}
